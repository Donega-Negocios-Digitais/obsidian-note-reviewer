# 13-01: Remove console.log and Configure Pino Logging

## Goal
Replace all console.log statements with proper logging system using Pino.

## Requirements
- QUAL-01: No console.log statements remain in production code
- QUAL-02: Pino logging system configured appropriately for production

## Success Criteria
1. All console.log/warn/error removed from production code
2. Pino logger configured and integrated
3. Different log levels for development vs production
4. Structured logging with relevant context
5. Logs are formatted appropriately for each environment

## Implementation

### Install Pino
```bash
bun add pino pino-pretty
```

### Create Logger Configuration
```typescript
// packages/core/src/logger/index.ts
import pino from 'pino';

const isDevelopment = import.meta.env.DEV;

export const logger = pino({
  level: isDevelopment ? 'debug' : 'info',
  formatters: {
    level: (label) => label,
  },
  browser: {
    asObject: true,
  },
  ...(isDevelopment && {
    transport: {
      target: 'pino-pretty',
      options: {
        colorize: true,
        ignore: 'pid,hostname',
        translateTime: 'HH:MM:ss',
      },
    },
  }),
});

// Type-safe logging methods
export const log = {
  debug: logger.debug.bind(logger),
  info: logger.info.bind(logger),
  warn: logger.warn.bind(logger),
  error: logger.error.bind(logger),
  fatal: logger.fatal.bind(logger),
};
```

### Create Logging Hooks
```typescript
// packages/ui/src/hooks/useLogger.ts
export function useLogger(component: string) {
  return {
    debug: (message: string, data?: unknown) =>
      log.debug({ component }, message, data),
    info: (message: string, data?: unknown) =>
      log.info({ component }, message, data),
    warn: (message: string, data?: unknown) =>
      log.warn({ component }, message, data),
    error: (message: string, error?: Error) =>
      log.error({ component, error: error?.message, stack: error?.stack }, message),
  };
}
```

### Remove console.log

#### Grep for all console statements
```bash
# Find all console.log
grep -r "console\.log" packages/ apps/

# Find all console.warn
grep -r "console\.warn" packages/ apps/

# Find all console.error
grep -r "console\.error" packages/ apps/
```

#### Replacement strategy
```typescript
// Before
console.log('User logged in', user);

// After
log.info({ userId: user.id, email: user.email }, 'User logged in');

// Before
console.error('Failed to fetch data', error);

// After
log.error({ error: error.message, stack: error.stack }, 'Failed to fetch data');
```

## Log Levels

### Development
- `debug`: Detailed information for debugging
- `info`: General informational messages
- `warn`: Warning messages
- `error`: Error messages with stack traces

### Production
- `info`: General informational messages (default)
- `warn`: Warning messages
- `error`: Error messages
- `fatal`: Critical errors requiring immediate attention

## Structured Logging

### Best Practices
```typescript
// Good: Structured with context
log.info({ userId, documentId, action }, 'Document updated');

// Bad: Unstructured string
log.info(`User ${userId} updated document ${documentId}`);

// Good: Error with metadata
log.error({
  error: error.message,
  stack: error.stack,
  userId,
  documentId,
}, 'Failed to save document');

// Bad: Error only
log.error('Failed to save', error);
```

## Files to Create
- `packages/core/src/logger/index.ts` - Logger configuration
- `packages/ui/src/hooks/useLogger.ts` - Logging hook

## Files to Modify
- All files with console.log statements (grep results)

## ESLint Rule

### Add no-console rule
```json
{
  "rules": {
    "no-console": ["error", { "allow": ["warn", "error"] }]
  }
}
```

## Verification

### Check for remaining console statements
```bash
# Should return nothing in production
grep -r "console\." packages/ apps/ --exclude-dir=node_modules
```

### Test logging
```typescript
// Test all log levels
logger.debug('Debug message');
logger.info('Info message');
logger.warn('Warn message');
logger.error('Error message');
logger.fatal('Fatal message');
```

## Notes
- Keep console.warn/error during development for React warnings
- Remove all console.log from production builds
- Use pino-pretty for development formatting
- Ship logs to external service in production (optional)
