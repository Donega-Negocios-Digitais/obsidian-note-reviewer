# 11-03: Configure DNS A Records to Point Subdomain

## Goal
Configure DNS A records at DNS provider to point r subdomain to Vercel.

## Requirements
- DEPL-03: DNS records point r subdomain to Vercel correctly

## Success Criteria
1. A records created at DNS provider
2. DNS resolves correctly to Vercel IPs
3. Domain is accessible via custom domain
4. SSL certificate is valid

## Implementation Steps

### 1. Identify DNS Provider
- alexdonega.com.br is registered with [provider]
- Login to DNS management console

### 2. Create A Records
Add the following records:

| Type | Host | Value | TTL |
|------|------|-------|-----|
| A | r | 76.76.21.21 | 3600 |
| A | r | 76.76.21.22 | 3600 |

### 3. Verify DNS Propagation
```bash
# Check DNS resolution
dig r.alexdonega.com.br

# Check with specific DNS server
dig @8.8.8.8 r.alexdonega.com.br

# Check from multiple locations
# Use: https://www.whatsmydns.net/
```

### 4. Wait for Propagation
- Usually 5-30 minutes
- Can take up to 24 hours
- Vercel will auto-detect when DNS is ready

### 5. Verify Domain in Vercel
- Vercel dashboard will show "Valid Configuration" when ready
- SSL certificate will provision automatically

## DNS Provider Specifics

### Cloudflare
1. Go to DNS → Records
2. Add A record:
   - Type: A
   - Name: r
   - IPv4 address: 76.76.21.21
   - Proxy status: DNS only (gray cloud)
3. Repeat for 76.76.21.22
4. Disable Cloudflare proxy (orange cloud) for Vercel

### Route 53 (AWS)
1. Go to Hosted Zones → alexdonega.com.br
2. Create Record Set:
   - Type: A Record
   - Name: r
   - Alias: No
   - TTL: 3600
   - Value: 76.76.21.21
3. Repeat for 76.76.21.22

### Namecheap
1. Go to Domain List → alexdonega.com.br → Manage
2. Go to Advanced DNS
3. Add New Record:
   - Type: A Record
   - Host: r
   - Value: 76.76.21.21
   - TTL: Automatic
4. Repeat for 76.76.21.22

### GoDaddy
1. Go to DNS Management
2. Add A Record:
   - Type: A
   - Host: r
   - Points to: 76.76.21.21
   - TTL: 1 hour
3. Repeat for 76.76.21.22

## Verification Commands

### Check DNS
```bash
# Basic check
dig r.alexdonega.com.br

# Check specific nameserver
dig @ns1.vercel.com r.alexdonega.com.br

# Check all nameservers
nslookup r.alexdonega.com.br

# Check from multiple locations
# Use: https://dnschecker.org/
```

### Check SSL
```bash
# Check certificate
openssl s_client -connect r.alexdonega.com.br:443 -servername r.alexdonega.com.br

# Check SSL labs
# https://www.ssllabs.com/ssltest/analyze.html?d=r.alexdonega.com.br
```

### Check HTTP
```bash
# Check response
curl -I https://r.alexdonega.com.br

# Check redirect
curl -I http://r.alexdonega.com.br

# Full response
curl -v https://r.alexdonega.com.br
```

## Troubleshooting

### DNS Not Propagating
- Check TTL setting
- Verify correct DNS provider
- Check for conflicting records
- Clear local DNS cache: `ipconfig /flushdns`

### SSL Not Provisioning
- Wait for DNS to fully propagate
- Check A records are correct
- Verify domain in Vercel dashboard
- Contact Vercel support if stuck

### 404 Errors
- Check vercel.json rewrites
- Verify build output directory
- Check for routing issues

### Redirect Loops
- Check vercel.json redirects
- Check for conflicting DNS records
- Verify environment variables

## Production Checklist
- [ ] A records created
- [ ] DNS propagates (check with dig)
- [ ] Vercel shows "Valid Configuration"
- [ ] SSL certificate issued
- [ ] Site loads via https://r.alexdonega.com.br
- [ ] HTTP redirects to HTTPS
- [ ] All pages load correctly

## Notes
- Always use both Vercel IP addresses for redundancy
- Disable proxy/cloudflare if using Cloudflare
- DNS-only mode ensures direct connection to Vercel
- HTTPS is automatic with Vercel
- SSL certificates renew automatically
