---
phase: 05-configuration-system
plan: 05
type: execute
wave: 3
depends_on: [08-02]
files_modified: [packages/ui/components/SettingsPanel.tsx, package.json]
autonomous: true

must_haves:
  truths:
    - "Hooks category shows clear configuration options and status"
    - "Can test hooks directly from settings"
    - "Language selector shows available languages (pt-BR, en-US)"
    - "Changing language updates interface immediately"
    - "Language preference persists to localStorage"
    - "9th category (Idioma) added and functional"
  artifacts:
    - path: "packages/ui/components/SettingsPanel.tsx"
      provides: "Enhanced hooks and new language selection"
      contains: "hooks tab with test buttons, idioma tab with language selector"
    - path: "package.json"
      provides: "i18next dependencies"
      contains: "react-i18next, i18next"
  key_links:
    - from: "idioma tab"
      to: "localStorage"
      via: "i18next language change"
      pattern: "i18n.changeLanguage|localStorage.setItem.*lang"
    - from: "hooks tab"
      to: "localStorage"
      via: "toggleHook"
      pattern: "localStorage.setItem.*obsreview-hooks"
---

<objective>
Enhance the hooks configuration with better UI and add a new 9th category for language selection (idioma) with i18next integration.

Purpose: Improve the hooks category with status indicators and test functionality, and add internationalization support allowing users to switch between Portuguese (pt-BR) and English (en-US).

Output: Enhanced hooks category and new language selector category with i18next integration.
</objective>

<execution_context>
@C:\Users\Alex\.claude\get-shit-done\workflows\execute-plan.md
@C:\Users\Alex\.claude\get-shit-done\templates\summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-configuration-system/08-RESEARCH.md

@.planning/phases/05-configuration-system/plans/05-02-SUMMARY.md
@packages/ui/components/SettingsPanel.tsx
@package.json
</context>

<tasks>

<task type="auto">
  <name>Install i18next dependencies</name>
  <files>package.json</files>
  <action>
Install react-i18next and i18next for internationalization support:

1. Run the installation command:
```bash
cd C:/dev/tools/obsidian-note-reviewer
bun add react-i18next i18next
```

2. Verify the packages are added to package.json:
- react-i18next
- i18next

These will be used for the language selection feature in the new idioma category.
  </action>
  <verify>package.json contains react-i18next and i18next in dependencies</verify>
  <done>i18next packages installed and ready for use</done>
</task>

<task type="auto">
  <name>Enhance hooks category with better UI and test functionality</name>
  <files>packages/ui/components/SettingsPanel.tsx</files>
  <action>
Redesign the 'hooks' category (currently around lines 480-533) with improved UI:

1. Redesign with Apple-style card layout and test buttons:
```tsx
{activeTab === 'hooks' ? (
  <div className="p-5 space-y-4 overflow-y-auto">
    {/* Header */}
    <div className="mb-2">
      <h4 className="text-sm font-semibold text-foreground">Hooks do Sistema</h4>
      <p className="text-xs text-muted-foreground">Configure integra√ß√µes autom√°ticas</p>
    </div>

    {/* Hooks list */}
    {hooks.map((hook) => (
      <div
        key={hook.id}
        className={`
          bg-card/50 rounded-xl border-2 p-4 transition-all
          ${hook.enabled
            ? 'border-primary/50 bg-primary/5'
            : 'border-border/50 bg-muted/30'
          }
        `}
      >
        <div className="flex items-start justify-between gap-4">
          <div className="flex-1 min-w-0">
            {/* Header with status */}
            <div className="flex items-center gap-2 mb-1">
              <h3 className="text-sm font-semibold text-foreground">{hook.name}</h3>
              {hook.enabled ? (
                <span className="px-2 py-0.5 text-[10px] bg-green-500/20 text-green-600 dark:text-green-400 rounded-full font-medium">
                  ‚úì Ativo
                </span>
              ) : (
                <span className="px-2 py-0.5 text-[10px] bg-muted/50 text-muted-foreground rounded-full font-medium">
                  Inativo
                </span>
              )}
            </div>

            {/* Description */}
            <p className="text-xs text-muted-foreground mb-2">
              {hook.description}
            </p>

            {/* Trigger badge */}
            <div className="inline-flex items-center gap-1.5 px-2 py-1 bg-muted/50 rounded-md">
              <svg className="w-3 h-3 text-muted-foreground" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}>
                <path strokeLinecap="round" strokeLinejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z" />
              </svg>
              <code className="text-[10px] font-mono text-muted-foreground">
                {hook.trigger}
              </code>
            </div>
          </div>

          {/* Actions column */}
          <div className="flex flex-col gap-2">
            {/* Toggle Switch */}
            <button
              onClick={() => toggleHook(hook.id)}
              className={`relative w-12 h-6 rounded-full transition-colors ${
                hook.enabled ? 'bg-primary' : 'bg-muted'
              }`}
            >
              <span
                className={`absolute top-0.5 w-5 h-5 bg-white rounded-full shadow-md transition-transform ${
                  hook.enabled ? 'translate-x-6' : 'translate-x-0.5'
                }`}
              />
            </button>

            {/* Test Button */}
            <button
              onClick={() => {
                // Simulate testing the hook
                alert(`Hook "${hook.name}" test would run here.\n\nThis would trigger: ${hook.trigger}`);
              }}
              className="px-2 py-1 text-[10px] font-medium text-muted-foreground hover:text-foreground bg-muted/30 hover:bg-muted/50 rounded-md transition-colors"
            >
              Testar
            </button>
          </div>
        </div>
      </div>
    ))}

    {/* Add new hook placeholder */}
    <div className="p-4 rounded-xl border-2 border-dashed border-border/50 text-center hover:border-border/80 transition-colors cursor-pointer group">
      <svg className="w-6 h-6 mx-auto text-muted-foreground/50 group-hover:text-muted-foreground transition-colors mb-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}>
        <path strokeLinecap="round" strokeLinejoin="round" d="M12 4v16m8-8H4" />
      </svg>
      <p className="text-xs text-muted-foreground/60 group-hover:text-muted-foreground transition-colors">
        Mais hooks ser√£o adicionados em breve
      </p>
    </div>
  </div>
) : ...}
```

2. Key improvements:
   - Better visual hierarchy with card layout
   - Status badges (Ativo/Inativo) with colors
   - Test button for each hook
   - Trigger displayed with lightning icon
   - Dashed border placeholder for future hooks

3. Ensure toggleHook persists to localStorage (already implemented).
  </action>
  <verify>hooks tab has redesigned cards with status badges, test buttons, and improved visual hierarchy</verify>
  <done>Hooks category enhanced with better UI and test functionality</done>
</task>

<task type="auto">
  <name>Add language selector category (9th category: Idioma)</name>
  <files>packages/ui/components/SettingsPanel.tsx</files>
  <action>
Add the 9th category "idioma" for language selection:

1. Update CategoryTab type:
```tsx
// Add 'idioma' to the type:
type CategoryTab = 'atomica' | 'terceiros' | 'organizacional' | 'alex' | 'regras' | 'identidade' | 'atalhos' | 'hooks' | 'idioma';
```

2. Add to tabs array (around line 247):
```tsx
const tabs: Array<{ id: CategoryTab; emoji: string; label: string }> = [
  { id: 'regras', emoji: 'üìã', label: 'Regras e Workflows' },
  { id: 'terceiros', emoji: 'üìö', label: 'Conte√∫do de Terceiros' },
  { id: 'atomica', emoji: '‚öõÔ∏è', label: 'Notas At√¥micas' },
  { id: 'organizacional', emoji: 'üó∫Ô∏è', label: 'Notas Organizacionais' },
  { id: 'alex', emoji: '‚úçÔ∏è', label: 'Conte√∫do Pr√≥prio' },
  { id: 'identidade', emoji: 'üë§', label: 'Identidade do Revisor' },
  { id: 'atalhos', emoji: '‚å®Ô∏è', label: 'Atalhos de Teclado' },
  { id: 'hooks', emoji: 'üîó', label: 'Hooks' },
  { id: 'idioma', emoji: 'üåê', label: 'Idioma' }, // NEW
];
```

3. Add language state and effect:
```tsx
const [currentLanguage, setCurrentLanguage] = useState(() => {
  return localStorage.getItem('app-language') || 'pt-BR';
});

useEffect(() => {
  // Load language preference
  const savedLang = localStorage.getItem('app-language') || 'pt-BR';
  setCurrentLanguage(savedLang);

  // Apply language to i18n when it's initialized
  // (Full i18n setup will be in a separate init file)
}, [isOpen]);
```

4. Add idioma tab content (before the final closing conditional):
```tsx
} else if (activeTab === 'idioma') {
  return (
    <div className="p-5 space-y-4 overflow-y-auto">
      {/* Header */}
      <div className="mb-2">
        <h4 className="text-sm font-semibold text-foreground">Idioma da Interface</h4>
        <p className="text-xs text-muted-foreground">Selecione seu idioma preferido</p>
      </div>

      {/* Language options */}
      <div className="space-y-2">
        {[
          { code: 'pt-BR', name: 'Portugu√™s (Brasil)', flag: 'üáßüá∑', native: 'Portugu√™s' },
          { code: 'en-US', name: 'English (United States)', flag: 'üá∫üá∏', native: 'English' },
        ].map((lang) => (
          <button
            key={lang.code}
            onClick={() => {
              setCurrentLanguage(lang.code);
              localStorage.setItem('app-language', lang.code);
              // In full implementation, this would call i18n.changeLanguage(lang.code);
              // For now, just store the preference
            }}
            className={`
              w-full flex items-center gap-4 p-4 rounded-xl border-2 transition-all
              ${currentLanguage === lang.code
                ? 'border-primary bg-primary/5'
                : 'border-border/50 bg-card/30 hover:border-border/80'
              }
            `}
          >
            {/* Flag */}
            <div className="text-3xl">{lang.flag}</div>

            {/* Language info */}
            <div className="flex-1 text-left">
              <div className="text-sm font-medium text-foreground">
                {lang.native}
              </div>
              <div className="text-xs text-muted-foreground">
                {lang.name}
              </div>
            </div>

            {/* Selected indicator */}
            {currentLanguage === lang.code && (
              <div className="w-6 h-6 rounded-full bg-primary flex items-center justify-center">
                <svg className="w-4 h-4 text-primary-foreground" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2.5}>
                  <path strokeLinecap="round" strokeLinejoin="round" d="M5 13l4 4L19 7" />
                </svg>
              </div>
            )}
          </button>
        ))}
      </div>

      {/* Info note */}
      <div className="p-3 rounded-xl bg-muted/30">
        <p className="text-xs text-muted-foreground text-center">
          üí° A tradu√ß√£o completa ser√° implementada em uma fase futura. Por enquanto, esta configura√ß√£o salva sua prefer√™ncia.
        </p>
      </div>
    </div>
  );
}
```

5. Update the conditional that adds padding (line 391) to include 'idioma':
```tsx
className={`${activeTab === 'regras' || activeTab === 'identidade' || activeTab === 'atalhos' || activeTab === 'hooks' || activeTab === 'idioma' ? '' : 'p-4'} overflow-y-auto flex-1`}
```

Note: The full i18n implementation (translating all UI text) will be done in a later phase. For now, this saves the language preference and demonstrates the UI.
  </action>
  <verify>SettingsPanel has 'idioma' tab added to tabs array and CategoryTab type, with language selector UI showing pt-BR and en-US options</verify>
  <done>Language selector category added as 9th settings category with preference persistence</done>
</task>

</tasks>

<verification>
After completion, verify:
1. react-i18next and i18next are in package.json
2. Hooks category has redesigned cards with status badges
3. Each hook has a Test button
4. 9th category "Idioma" appears in sidebar with üåê icon
5. Language selector shows pt-BR and en-US options
6. Selecting a language saves to localStorage
7. Selected language shows checkmark indicator
8. All hooks still toggle and persist correctly
</verification>

<success_criteria>
1. i18next packages installed
2. Hooks category redesigned with better UX
3. Test buttons functional for each hook
4. Language selector category added
5. Language preference persists to localStorage
6. All 9 categories visible in sidebar
</success_criteria>

<output>
After completion, create `.planning/phases/05-configuration-system/plans/05-05-SUMMARY.md` with:
- Hooks enhancement details
- Language selector implementation
- i18next package installation
- Notes for full i18n implementation in future phase
</output>
